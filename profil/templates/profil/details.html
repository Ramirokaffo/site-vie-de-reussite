{% extends "profil/base.html" %}
{% load static %}


{% block content %}
<link rel="stylesheet" href="{% static 'profil/details.css' %}">
<script id="video-script" src="https://www.youtube.com/iframe_api"></script>
<script id="video-script"></script>
<script id="video-script" src="{% static 'profil/script.js' %}"></script>
<div class="main-content">
    <section class="left-section">
        <div class="video-frame" style="width: 100%; height: 600px;">

            <div class="video-loader" id="video-loader">Loading
                <span></span>
            </div>
            <div class="ebook-illustration_video" id="video-id" yt_v_id="{{ current_video.video }}" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen></div>
        </div>
        <h2 class="current_video_title">{{ current_video.title }}</h2>
        <hr>
        <section class="bottom-section">
            <div class="tab-bar-div">
                <button class="description-btn-tab selected-tab" id="descriptionBtn">Description</button>
                <button class="comment-btn-tab" id="commentBtnId">Commentaire</button>
            </div>
            <div class="video-descriptiion" id="video-descriptiion">
            {% if current_video.decription %}
            <!-- </div> -->
            {{ current_video.decription|safe }}
            {% else %}
            <p>Aucune desciption disponible pour cette vidéo</p>
            {% endif %}
            <a id="shortcut_to_comment" onclick="showComment()">Afficher les commentaires</a>
        </div>
            <div class="comment-div" id="comment-div">
                <div id="comment-list">

                    {% for comment in video_comments %}
                    <div class="one-comment-div">
                        <svg height="50" width="50" xmlns="http://www.w3.org/2000/svg" fill="var(--color3)"
                            viewBox="0 0 24 24">
                            <path fill-rule="evenodd"
                                d="M12 20a8 8 0 0 1-5-1.8v-.6c0-1.8 1.5-3.3 3.3-3.3h3.4c1.8 0 3.3 1.5 3.3 3.3v.6a8 8 0 0 1-5 1.8ZM2 12a10 10 0 1 1 10 10A10 10 0 0 1 2 12Zm10-5a3.3 3.3 0 0 0-3.3 3.3c0 1.7 1.5 3.2 3.3 3.2 1.8 0 3.3-1.5 3.3-3.3C15.3 8.6 13.8 7 12 7Z"
                                clip-rule="evenodd" />
                        </svg>
                        <div class="one-comment-div-right">
                            <div class="one-comment-div-right-header">
                                {% if comment.author.id == request.user.id %}
                                <h5>Vous</h5>

                                {% else %}
                                <h5>{{ comment.author }} </h5>

                                {% endif %}

                                <i>{{ comment.created_at }}</i>

                            </div>
                            <p>{{ comment.content }}</p>
                            <hr>

                        </div>

                    </div>

                    {% empty %}
                    <p>Aucun commentaire disponible</p>
                    {% endfor %}
                </div>

                <div id="comment-form-id" message_url="{% url 'formation:comment' %}" userId="{{ request.user.id }}"
                    videoId="{{ current_video.id }}">
                    {% csrf_token %}
                    <h3>Laisser un commentaire</h3>
                    <textarea name="userComment" id="userComment" cols="30" rows="5" required
                        placeholder="Exprimez-vous ici..."></textarea>
                    <div class="send-comment-div">

                        <button type="" id="sendCommentBtn">
                            <div id="dotSpinnerComment">
                                <div class="dots"></div>
                            </div>Ajouter mon commentaire
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </section>
    <section class="right-section">
        {% if next_video %}
        <a style="visibility: hidden;" id="next-video-a"
            href="{% url 'profil:detail' next_video.formation_id %}?current_v_index={{ next_video.id }}"></a>

        {% endif %}
        <ul>
            {% for video in videos %}

            {% if current_video.id == video.id %}
            <li class="current_video" id="current_video_li">
                <a href="{% url 'profil:detail' video.formation_id %}?current_v_index={{ video.id }}">
                    {{ video.title }}</a>
            </li>

            {% else %}
            <li>
                <a href="{% url 'profil:detail' video.formation_id %}?current_v_index={{ video.id }}">
                    {{ video.title }}</a>
            </li>

            {% endif %}

            <hr>
            {% empty %}
            <p>Aucune vidéo disponible</p>
            {% endfor %}
        </ul>
    </section>
</div>
{% endblock content %}